---
title             : "Parents spontaneously scaffold the formation of conversational pacts with their children"
shorttitle        : "Parents scaffold pacts"

author: 
  - name          : "Ashley Leung"
    affiliation   : "1"
  - name          : "Daniel Yurovsky"
    affiliation   : "2"
  - name          : "Robert D. Hawkins"
    affiliation   : "3"
    corresponding : yes 
    address       : "Princeton University"
    email         : "rdhawkins@princeton.edu"

    

affiliation:
  - id            : "1"
    institution   : "Department of Psychology\\comma\\hspace{.25em} University of Chicago"
  - id            : "2"
    institution   : "Department of Psychology\\comma\\hspace{.25em} Carnegie Mellon University"
  - id            : "3"
    institution   : "Princeton Neuroscience Institute\\comma\\hspace{.25em} Princeton University"

abstract: |
   Adults readily coordinate on temporary *pacts* about how to refer to things in conversation. Young children are also capable of forming pacts with peers given appropriate experimenter intervention. Here, we investigate whether parents may *spontaneously* provide a similar kind of scaffolding with US children in a director-matcher task ($N=201$, 49\% female; ages 4, 6, 8). In Experiment 1, we show that parents initiate more clarification exchanges with younger children who, in turn, are more likely to adopt labels introduced by the parent. We then examine whether the benefit of such scaffolding acts primarily on childrens' difficulties with comprehension (Experiment 2) or production (Experiment 3). Our findings suggest that parents primarily scaffold pacts by easing children's production difficulties, modeling cooperative communication.
  
authornote: |
  All data and code for these analyses are available at https://osf.io/vkug8/?view_only=b68061f8daae48cdace5c3dc53969405. Videos of experiment sessions are available on Databrary.

keywords          : "parent-child interaction; language development; communication"
wordcount         : "10675"
references        : "42"

bibliography      : ["tangram.bib"]

floatsintext      : yes
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no
documentclass     : "apa7"
classoption       : "man"
csl               : "`r system.file('rmd', 'apa7.csl', package = 'papaja')`"
header-includes   : |
    \let\comma,
    \makeatletter
    \renewcommand{\paragraph}{\@startsection{paragraph}{4}{\parindent}%
      {0\baselineskip \@plus 0.2ex \@minus 0.2ex}%
      {-1em}%
      {\normalfont\normalsize\bfseries\typesectitle}}
    \newcommand{\beginsupplement}{
      \setcounter{table}{0}  
      \renewcommand{\thetable}{S\arabic{table}} 
      \setcounter{figure}{0} 
      \renewcommand{\thefigure}{S\arabic{figure}}}
    \renewcommand{\subparagraph}[1]{\@startsection{subparagraph}{5}{1em}%
      {0\baselineskip \@plus 0.2ex \@minus 0.2ex}%
      {-\z@\relax}%
      {\normalfont\normalsize\bfseries\itshape\hspace{\parindent}{#1}\textit{\addperi}}{\relax}}
    \makeatother
    
output            : papaja::apa6_pdf

---

```{r load-packages, include = FALSE}
library(png)
library(grid)
library(egg)
library(xtable)
library(knitr)
library(papaja)
library(lme4)
library(lmerTest)
library(directlabels)
library(ggrepel)
library(here)
library(scales)
library(tidyboot)
library(broom)
library(broom.mixed)
library(patchwork)
library(kableExtra)
library(english)
library(ggthemes)
library(effectsize)
library(glue)
library(tidyverse)
library(tidytext)
library(textstem)
library(entropy)
library(janitor)
library(stringdist)
library(tm)

# load in helper functions
box::use(./sections/helpers)
box::reload(helpers)

theme_set(theme_few(base_size = 10) + theme(legend.position = "none"))

knitr::opts_chunk$set(echo = FALSE, cache = TRUE, 
                      warning = FALSE, message = FALSE, 
                      sanitize = TRUE, fig.path='figs/', fig.pos = "t!")
set.seed(42)
options(digits=3, dplyr.summarise.inform = FALSE)
options(knitr.table.format = "latex")
```

Children don't just learn the sounds, words, and structures of language---they learn how to *use language to communicate* [@hockett1960; @clark2009first]. 
A core aspect of communication is our sensitivity to *common ground*. 
We produce and interpret language for each other in light of our shared history, and expect others to do the same [@bruner1985; @Clark96_UsingLanguage; @brown2009partner; @brown2015people]. 
For example, the same entity can be referred to as *Max* with family members, but *our dog* or *our pug* would be more appropriate with strangers who cannot be expected to know his name [@brown1958shall]. 
When the meaning of an utterance is unclear, or when an intended referent does not have a conventional label, interlocutors will engage in negotiation, collaboratively arriving at a shared conversational *pact* about how to think and talk about the intended referent [@clark1986; @haber-etal-2019-photobook; @hawkins2019]. 
These pacts are temporary agreements about referent names, and adults fluently form, revise, and track them over time with different partners. 
For instance, Brennan and Clark [-@brennan1996] showed that adults will use the contextually appropriate level of specificity for a referent (e.g. "loafer" rather than "shoe" when another shoe is present), carry it forward into a new context with the same conversational partner (even when the initial competitor is removed), then revert to the simpler "shoe" when a new partner is introduced. 

While adults readily form pacts with one another, studies examining *peer interactions* between children have yielded more mixed results [see @stephens2014referential for a review]. 
In a classic set of studies, Krauss and Glucksberg [-@krauss1977] asked pairs of age-matched children to play a director-matcher game that required them to refer to novel objects by themselves [see also @glucksberg1966; @glucksberg1967; @krauss1969]. 
Across repeated interactions with the same novel objects, 5- and 6-year-old children showed very little evidence of pact formation. 
The matcher's accuracy in selecting the correct referent remained low, and the director did not increase the efficiency of their referential expressions as adults do. 
These classic results are perhaps surprising from a contemporary perspective, given that children engage in relatively fluent conversation at this age and are able to track at least some aspects of common ground when engaging in scripted interactions with an adult experimenter as a partner [@vasil2023new], including visual perspective [@nadig2002evidence; @nilsen2009relations; @khu2020preschoolers] and referential precedence [@matthews2010; @ostashchenko2019referential; @yoon2021s; @akhtar1996role; @graham2014]. 
However, as @koymen2014 note, "establishing referential pacts with adult experimenters who provide scripted utterances might undermine the spontaneity and the mutual agreement on a referential term, since children are simply presented with referential terms and are not actively creating referential pacts themselves" (p. 2335).
Even more surprising, then, are recent studies of spontaneous interactions between pairs of children as young as 4 years old, who *are* in some cases able to get pacts off the ground by themselves [@koymen2014; @branigan2016], most notably in non-verbal gesturing paradigms [@bohn2019young; @lister2021cross].

Why do pairs of children apparently succeed in some studies but fail in others?
One key factor may be the presence or absence of targeted input or feedback from adult experimenters. 
For example, @koymen2014 explicitly prompted 4- to 6-year-old participants to ask clarification questions when their partner was underinformative (asking "do you know what he/she means?" and saying "You can ask him/her" when they said no), mediated negotiation over pacts ("I say we give a name to this boy/girl. Do you have any idea?") and provided immediate feedback when they failed to use the pact ("And who are they?").
Similar effects of experimenter feedback were noted as far back as @krauss1977 ("Children in the first, third, and fifth grades did improve, with the help of comments from the experimenter pointing out the mistakes they had been making.")
Developmental changes were also observed in these more recent studies, indicating that the underlying mechanisms may be graded and continue to develop into middle childhood. 
For example, @koymen2014 found that 6-year-olds were more sensitive to referential pacts than 4-year-olds, who were only reliably sensitive when the pacts were proper nouns, even in the presence of extensive prompting. 
And while @branigan2016 found that while 8- to 10-year-old participants were able to coordinate on pacts given explicit feedback about their accuracy, their error rates were still higher in absolute terms than adults.
Thus, relatively targeted experimenter intervention may be required for children to successfully construct conversational pacts with their peers; the ability to reliably initiate the requisite speech acts on their own may not develop until later.

In everyday conversation, children do not have access to explicit mediation from experimenters.
It is possible, however, that parents may *spontaneously* scaffold referental pacts with their children in a similar way.
Parents are not only more linguistically capable than their peers, but also have fine-grained representations about their children's knowledge and conversational abilities [@leung2021]. 
Parental scaffolding may not only help facilitate effective communication in the local context, but also serve to model dialogue skills that children may gradually adopt more globally.
Our investigation thus begins in Experiment 1 by asking what parents may be doing spontaneously to support the formation of conversational pacts when talking with their children. 
We do not aim here to make direct comparisons between parent-child interactions and peer-to-peer interactions. 
Instead, we focus on the parent-child setting and consider three potential obstacles to initially establishing pacts where adult scaffolding may help:

**Utterance-level comprehension:** In order to identify the target of a referential utterance, children must determine whether the information contained in it is a good description of each potential referent. There is extensive evidence that by 4 years old, children can track partner-specific perspectives during comprehension; for example, @nadig2002evidence found that children use information from previous interactions to look towards the correct target image as their partner's speech unfolds [see also, @bleijlevens2023pragmatics; @akhtar1996role; @bohn2021children]. However, it is possible that in contexts with more complex referring expressions for novel objects (like the tangrams we use) children may struggle to identify the target of an utterance, even if it would be perfectly informative for an adult listener [@speer1984two].
<!-- . For example, given a complex referring expression like "the shoe with the brown laces," they may only attend to a sub-expression like "shoe" and lose the modifying phase -->

**Utterance-level production:** Alternatively, the primary source of communicative difficulty may lie on the production side. Children may generate referential expressions that are either overly idiosyncratic or insufficiently informative for their conversational partner to correctly identify the intended referent [@rabagliati2017children; @beal1983young; @beal1988children]. For familiar objects, conventional labels may provide a good-enough default [@goldberg2022good; @koranda2022good], but more challenging contexts with unfamiliar objects may place additional demands on production. Children are also known to struggle to determine which referential expressions would be more or less informative in context [@beal1982; @whitehurst1978development], even for idiosyncratic expressions they themselves produced at an earlier time [@asher1976; @robinson1977].

**Discourse-level interaction:** Finally, the difficulty may lie beyond the level of single utterances, implicating the interactive discourse processes that link together production and comprehension. For example, children may experience no more or less difficulty in production or comprehension than adults, but struggle to notice and actively signal to their partners that they have not understood each other. Adults readily use back-channels and other vocal affirmations to signal that they have understood a potentially ambiguous utterance [@clark2008repetition], and will ask clarifying questions when they feel they have been unable to understand [@clark1986; @schegloff_2007]. However, young children may have trouble proactively initiating these speech acts when necessary, and errors may persist preventing pacts from getting off the ground [@anderson1994; @beal1987repairing]. 

<!-- The rest of the paper aims to disentangle the contributions of children's comprehension and production skills. -->
<!-- In Study 2, we isolated the role of comprehension processes by asking naive adults and children to identify the target reference given the utterances originally produced in our parent-child interactions. -->
<!-- In Study 3, we isolated the role of production by asking children and adults to describe familiar and novel objects in contexts with different pragmatic demands.  -->
<!-- Overall, we found that comprehension is relatively constant across development, but younger children produce both more lexically idiosyncratic and less context-sensitive labels. -->
<!-- These findings suggest that impaired production may prevent pacts from taking root in pairs of young children, but when adults are able to provide enough interactional scaffolding, even very young children are able to adapt and establish common ground.  -->

```{r child = "sections/parent-child.Rmd"}
```

```{r child = "sections/comprehension.Rmd"}
```

```{r child = "sections/production.Rmd"}
```

# General Discussion

Successful communication crucially depends on the ability to establish common ground and coordinate on conversational pacts with partners. 
A long literature of developmental work dating back to Krauss and Glucksberg [-@krauss1977] has revealed surprising failures to interactively form adult-like pacts even among children who are sensitive to partner-specific perspective and referential precedent in interactions with adult experimenters [@nadig2002evidence; @nilsen2009relations; @khu2020preschoolers; @matthews2010; @ostashchenko2019referential; @yoon2021s; @akhtar1996role; @graham2014]. 
Here, we turned to parent-child interactions for insight, asking whether parents may be adopting some of the strategies used by experimenters to elicit pacts in recent studies [e.g. @koymen2014]. 
We found that the obstacles to pact formation are, to some extent, resolved through spontaneous parental scaffolding: parents of younger children engaged in more conversational turns, asked more clarification questions, produced longer referential expressions, and adopted less complex labels.
We then conducted two additional studies to disentangle the contribution of comprehension and production processes, determining that children's *production* is likely to present the root problem that parental scaffolding is adapted to overcome.

Our studies contribute to the debate over *why* young children may struggle to form referential pacts with peers in some cases and not in others, especially given extensive evidence that they are capable of tracking pacts introduced by adult experimenters [@matthews2010; @graham2014]. 
One classic family of explanations implicates theory of mind development: children may fail to take their partner's perspective into account and stubbornly produce idiosyncratic descriptions that are not meaningful to anyone else [@krauss1977]. 
Another family of explanations implicates sensitivity to informativeness given the demands of production: children may be focused on generating an appropriate standalone label for the target while neglecting to consider whether it might also apply to the foil [@speer1984two].
Our study emphasizes a third possibility. 
Young children may be unable to produce a good-enough label for an unfamiliar object on their own, due to weak lexical priors for what to call unfamiliar objects, and unable to initiate clarification.
Once presented with a good-enough label, and prompted to confirm that they understand it, however, they are flexible enough to readily adopt and use it themselves on future trials.

One important limitation of our study is the reliance on the existing empirical literature documenting successes and failures of pact formation in child-child peer communication, rather than more directly replicating these phenomena ourselves in the same paradigm we used to study parent-child communication.
It is possible that our paradigm differs in important ways from those used in prior work and pairs of children would, in fact, succeed at forming conversational pacts without experimenter intervention in our variant. 
For example, our task used contexts containing only two tangram images per trial, whereas classic studies used contexts of six or more. 
This choice could have reduced the cognitive load in our variant, allowing child-child pairs to perform as well as our parent-child pairs.
At the same time, there are several reasons to believe that pairs of children would still struggle in our variant, including the production failures we independently observed in Experiment 3 and the observation than younger children relied more heavily on parent-generated descriptions in Experiment 1. 
Further experiments are necessary to replicate classic child-child phenomena under our paradigm, or replicate our parent-child phenomena under classic paradigms.

Taken together, these studies contribute to the growing understanding of parental scaffolding in language development more broadly. 
As children encounter novel concepts and situations they do not yet have words to describe, they must be particularly attuned to the distribution of labels that appear to be acceptable to competent speakers. 
Beyond the benefits of child-directed speech [@manybabies2020quantifying] and careful tailoring of labels to the child's vocabulary [@leung2021], adults may spontaneously adopt some of the higher-order discourse strategies examined in training studies [@matthews2007].
These more interactive forms of scaffolding go beyond a single utterance to draw attention to sources of ambiguity and expose the need to actively check for mutual understanding. 
The everyday process of parents and children trying to understand one another may in this way not only scaffold the formation of conversational pacts, but of communicative development more broadly.

<!-- # Acknowledgements -->

<!-- This research was funded by James S. McDonnell Foundation Scholar Award in Understanding Human Cognition \#220020506 to DY. -->

\newpage

# References

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id = "refs"></div>
\endgroup

# Supplemental Information

\beginsupplement

## Appendix A: Exchanges with younger children contained more questions

```{r question-marks}
questionMarks <- exchanges_data %>% 
  filter(person == 'parent', role == 'matcher') %>% 
  mutate(containQ = str_detect(utterance, "\\?")) %>% 
  rowwise() %>%
  mutate(age = paste0(c('age', age), collapse = "")) %>%
  group_by(age, containQ) %>% 
  tally() %>% 
  group_by(age) %>%
  mutate(proportion = n / sum(n)) %>%
  ungroup()

questionMarkProportions <- questionMarks %>%
  filter(containQ) %>%
  select(age, proportion) %>%
  pivot_wider(names_from = age, values_from = proportion)

chisq.out <- questionMarks %>% 
  select(age, containQ,n) %>%
  spread(containQ,n) %>% 
  select(-age) %>%
  chisq.test() %>%
  tidy()
```


```{r question-count, fig.show='hide'}
questionMarkCount <- exchanges_data %>% 
  filter(role == "matcher") %>%
  mutate(containQ = str_detect(utterance, "\\?")) %>% 
  rowwise() %>%
  mutate(age = paste0(c('age', age), collapse = "")) %>%
  group_by(person, age, rep_num, target, subid, containQ) %>% 
  tally() %>% 
  group_by(age, person, subid, rep_num, target) %>%
  ungroup() %>%
  pivot_wider(names_from = containQ, values_from = n) %>%
  mutate(`FALSE` = if_else(is.na(`FALSE`), 0, as.numeric(`FALSE`)),
         `TRUE` = if_else(is.na(`TRUE`), 0, as.numeric(`TRUE`))) %>%
  pivot_longer(cols = c(`FALSE`, `TRUE`), names_to = "has_question", 
               values_to = "n") %>%
  group_by(person, age, rep_num, subid, target) %>%
  mutate(prop = n / sum(n)) %>%
  mutate(has_question = as.logical(has_question)) %>%
  filter(has_question) %>%
  group_by(person, age, rep_num, subid) %>%
  summarise(prop = mean(prop), n = mean(n))

questionMarkBooted <- questionMarkCount %>%
  group_by(age, person, rep_num) %>%
  tidyboot_mean(n) 

questionMarkBooted %>%
  ggplot(aes(x = rep_num, y = empirical_stat, color = person)) + 
  facet_grid(. ~ age) + 
  geom_pointrange(aes(ymin = ci_lower, ymax = ci_upper)) + 
  geom_line()
```

Lengthier parent-child exchanges may reflect efforts by parents to provide and elicit additional clarification or confirmation, or may simply reflect attentional difficulties. 
As a rough estimate of the content of parents' responses when their child was the director, we counted the number of question marks in the transcripts of parents' responses.
Because questions were not always annotated with a question mark, this analysis represents a lower bound on the true estimate of questions. 
We found `r questionMarkProportions$age4 * 100`% of responses to 4-year-olds contained question marks, compared to lower rates of `r questionMarkProportions$age6 * 100`% and `r questionMarkProportions$age8 * 100`% in 6- and 8-year-olds, respectively ($\chi^2(2)=$ `r chisq.out$statistic`, $p$ `r papaja::printp(chisq.out$p.value)`).
It is possible that these proportions reflect an artifact of the transcriptions, but the same RAs transcribed sessions across multiple age groups, applying a consistent strategy.
We expect the population of parents to be roughly comparable across children's age groups, hence there is no *a priori* reason one group would be transcribed differently than others.

## Appendix B: How do pacts differ across ages?


```{r aoa-computation, cache = TRUE}
tokens <- combined_data %>%
  filter(role == "director") %>%
  group_by(age, person, subid, target, rep_num) %>%
  summarise(words = str_to_lower(utterance)) %>%
  ungroup() %>%
  unnest_tokens(word, words) %>%
  ungroup() %>%
  mutate(word = str_to_lower(word))

aoas <- tokens %>%
  left_join(kuperman_aoas, by = "word") %>%
  filter(!word %in% tm::stopwords()) %>%
  group_by(age, person, target, rep_num, subid) %>%
  summarise(aoa = mean(aoa, na.rm = T)) %>%
  group_by(age, person, target, subid) %>%
  ungroup() %>%
  mutate(person = case_when(person == "left" ~ "adult",
                            person == "right" ~ "adult",
                            T ~ person))

mean_aoas <- aoas %>%
  mutate(age = if_else(is.na(age), "adult", as.character(age))) %>%
  group_by(age, person, rep_num, subid) %>%
  summarise(aoa = mean(aoa, na.rm = T)) %>%
  tidyboot_mean(aoa, na.rm = T) %>%
   mutate(plot_person = case_when(person == "adult" ~ "adult",
                                 person == "parent" ~ "parent",
                                 T ~ "child"))

lmer.aoas <- aoas %>%
  filter(!is.na(age)) %>%
  mutate(age = as.numeric(age) - 6, rep_num = rep_num - 2.5) %>%
  lmer(aoa ~ person * age * rep_num + (rep_num * person  | subid) +
         (1 | target), data = ., control = lmerControl(optimizer = "bobyqa")) %>%
  tidy() %>%
  filter(effect == "fixed")
```

```{r aoa-effects}
age_effect_origin = lmer.aoas %>% filter(term == 'age')
age_effect_origin_pvalue <- round(age_effect_origin$p.value, 3)
age_effect_origin_pvalue <- ifelse(age_effect_origin_pvalue < 0.001, 
                               '< 0.001', paste0(c('=', age_effect_origin_pvalue),
                                                 collapse = ' '))

rep_effect_origin = lmer.aoas %>% filter(term == 'rep_num')
rep_effect_origin_pvalue <- round(rep_effect_origin$p.value, 3)
rep_effect_origin_pvalue <- ifelse(rep_effect_origin_pvalue < 0.001, 
                               '< 0.001', paste0(c('=', rep_effect_origin_pvalue),
                                                 collapse = ' '))

person_effect_origin = lmer.aoas %>% filter(term == 'personparent')
person_effect_origin_pvalue <- round(person_effect_origin$p.value, 3)
person_effect_origin_pvalue <- ifelse(person_effect_origin_pvalue < 0.001, 
                               '< 0.001', paste0(c('=', person_effect_origin_pvalue), collapse = ' '))

person_age_interaction_origin = lmer.aoas %>% filter(term == 'personparent:age')
person_age_interaction_origin_pvalue <- round(person_age_interaction_origin$p.value, 3)
person_age_interaction_origin_pvalue <- ifelse(person_age_interaction_origin_pvalue < 0.001, 
                               '< 0.001', 
                               paste0(c('=',
                                        person_age_interaction_origin_pvalue), 
                                      collapse = ' '))

person_rep_interaction_origin = lmer.aoas %>% filter(term == 'personparent:rep_num')
person_rep_interaction_origin_pvalue <- round(person_rep_interaction_origin$p.value, 3)
person_rep_interaction_origin_pvalue <- ifelse(person_rep_interaction_origin_pvalue < 0.001, 
                                                  '< 0.001', paste0(c('= ', person_rep_interaction_origin_pvalue), collapse = ' '))

age_rep_interaction_origin = lmer.aoas %>% filter(term == 'age:rep_num')
age_rep_interaction_origin_pvalue = round(age_rep_interaction_origin$p.value, 3)
age_rep_interaction_origin_pvalue <- ifelse(age_rep_interaction_origin_pvalue < 0.001, 
                                                  '< 0.001', paste0(c('= ', age_rep_interaction_origin_pvalue), collapse = ' '))

person_age_rep_interaction_origin = lmer.aoas %>% filter(term == 'personparent:age:rep_num')
person_age_rep_interaction_origin_pvalue = round(person_age_rep_interaction_origin$p.value, 3)
person_age_rep_interaction_origin_pvalue <- ifelse(person_age_rep_interaction_origin_pvalue < 0.001, 
                                                  '< 0.001', paste0(c('= ', person_age_rep_interaction_origin_pvalue), collapse = ' '))
```

```{r aoa-appendix, fig.pos = "t", fig.width=6, fig.height=3.5, fig.align = "center", fig.cap = "\\label{fig:aoa_appendix}Complexity of language used by different age groups estimated from words' average age of acquisition. Error bars are 95\\% CI."}
aoa_labels = tibble(rep_num = c(2, 1.6, 2), 
                          empirical_stat = c(4.5, 4, 4.1), 
                          plot_person = c("parent", "child", "adult"),
                          plot_age = c("parent", "child", "adult"),
                          age = c("4", "4", "adult"))

ggplot(mean_aoas, aes(x = rep_num, y = empirical_stat,
                                      color = plot_person)) +
  facet_grid(~ age) +
  geom_linerange(aes(ymin = ci_lower, ymax = ci_upper),
                 position = position_dodge(.25)) + 
  geom_line(position = position_dodge(.25)) + 
  theme(aspect.ratio = 1, legend.position = "none") +
  labs(x = "rep #", y = "AoA (average)") +
  scale_color_manual(values = c( ADULTS, CHILD_SCALE[2], PARENTS)) +
  geom_text(aes(label = plot_age), data = aoa_labels)
```

Given that the labels used by younger children tend to originate with their parents, it is tempting to conclude that adaptation for these pairs is entirely one-sided. However, the resulting pacts may have nonetheless been shaped by children. In particular, we suggest that even though young children may not be able to *supply* good initial labels, they may serve as "simplifiers" or "filters" that constrain the complexity of the resulting pact, since it must pass through their comprehension and production system [@hudson-kam2005].
We tested this hypothesis by asking about the linguistic complexity of the pacts developed in each age group. To estimate the complexity of individual words, we used self-reported age of acquisition (AoA) estimates [@kuperman2012]. Our assumption, based on Kuperman et al.'s work, is that more complex words are harder to acquire, and thus have later ages of acquisition (AoA). To estimate the complexity of referential expressions as a whole, we simply averaged the AoAs of all the words they contained^[We first removed any words in a list of `r length(tm::stopwords())` stop words like "at" and "me" from the \texttt{tm} package [@feinerer2008]]. 
As children get older, both their expressions and their parents' become more linguistically complex over repetitions of the same tangram (like adults) (Figure \ref{fig:aoa_appendix}). 
For parents interacting with 4-year-old children, the eventual pacts had $AoA \approx 4.2$; for parents interacting with 8-year-old children, the eventual pacts had $AoA \approx 5.0$, closer to the pacts formed between pairs of adults in our control group. 
Thus, adults who were interacting with a 4-year-old ended up using less complex pacts than adults interacting with older children or other adults.

We confirmed this observation with a mixed-effects model including all possible interactions of age, person (child vs. parent), and repetition number, and maximal random effect structure as before. We found significant main effects of age ($\beta=$ `r age_effect_origin$estimate`, $t =$ `r age_effect_origin$statistic`, $p$`r age_effect_origin_pvalue`), and person ($\beta=$ `r person_effect_origin$estimate`, $t=$ `r person_effect_origin$statistic`, $p$ `r person_effect_origin_pvalue`), but not repetition ($\beta=$ `r rep_effect_origin$estimate`, $t =$ `r rep_effect_origin$statistic`, $p$ `r rep_effect_origin_pvalue`). All else being equal, pairs with older children produced more complex utterances, and parents produced more complex utterances than children. Further, we found a significant interaction between age and repetition number, suggesting that later repetitions became more complex for dyads with older children ($\beta=$ `r age_rep_interaction_origin$estimate`, $t=$ `r age_rep_interaction_origin$statistic`, $p$ `r  age_rep_interaction_origin_pvalue`). This interaction may be driven by reduction processes, as more distinctive words tend to persist as common words are dropped [@hawkins2019]. No other effects were significant, indicating that parents' utterances remained a constant level of complexity above children's even as children's utterances became more complex. These results suggest that pact formation depends not only on parental input, but on children as well---pacts may originate from parents, but children control their complexity.

## Appendix C: Descriptions produced by children are less comprehensible than those produced by adults

```{r full-acc-lmer}
additive_acc.lmer <- bind_rows(tidy_turk_data, tidy_kid_data) %>%
  filter(measure == "correct") %>%
  glmer(value ~ person + scale(age) + occurrence + (1 | target) + (1 + person | subid),
         family = "binomial", data = ., contrasts = list(person = contr.sum(n = 2, contrasts = T))) 

two_way_acc.lmer <- bind_rows(tidy_turk_data, tidy_kid_data)  %>%
  mutate(occurrence = factor(occurrence)) %>%
  filter(measure == "correct") %>%
  glmer(value ~ person + scale(age) * occurrence + (1 | target) + (1 + person | subid),
         family = "binomial", data = ., 
        contrasts = list(person = contr.sum(n = 2),
                         occurrence = contr.sum(n = 2))) 

three_way_acc.lmer <- bind_rows(tidy_turk_data, tidy_kid_data)  %>%
  mutate(occurrence = factor(occurrence)) %>%
  filter(measure == "correct") %>%
  glmer(value ~ person * scale(age) * occurrence + (1 | target) + (1 + person | subid),
         family = "binomial", data = ., 
        contrasts = list(person = contr.sum(n = 2),
                         occurrence = contr.sum(n = 2)),
        control = glmerControl(optimizer = 'bobyqa')) 

acc.lmer.anova <- anova(additive_acc.lmer,three_way_acc.lmer) %>% 
  tidy() %>% 
  filter(term == 'three_way_acc.lmer')

additive_acc.lmer <- additive_acc.lmer %>%
  tidy() %>%
  filter(effect == "fixed") %>%
  select(-effect, -group)

acc.lmer.speaker <- additive_acc.lmer %>% filter(term == 'person1')
acc.lmer.age <- additive_acc.lmer %>% filter(term == 'scale(age)')
acc.lmer.occ <- additive_acc.lmer %>% filter(term == 'occurrence')
```

Next, we examine which features of the descriptions may affect downstream comprehension.
We consider two specific hypotheses. 
First, we predicted that descriptions produced by adults will be easier for *everyone* to comprehend, overall, than descriptions produced by children in the same dyad. 
Second, we predicted that descriptions produced earlier in the game will be easier to comprehend than descriptions produced later in the game, consistent with prior findings that pacts are not always transparent to eavesdroppers [@schober1989understanding]. 
Because we found no overall differences in comprehension group in the previous section, we collapse across both adult and child comprehenders for the following analyses (see Figure \ref{tab:comprehension} for a model with all effects).

To test these predictions, we fit a logistic mixed effects model predicting accuracy as a function of the person who produced the description (parent vs. child), the age of child in the pair (ages 4, 6, 8), and the phase of the game where it was produced (early vs late).
We also include random intercepts for each target and participant ID; a more complex model adding interactions was not justified, $\chi^2(`r acc.lmer.anova$df`) = `r acc.lmer.anova$statistic`, p=`r acc.lmer.anova$p.value`$. 
How does age of speaker influence comprehension of descriptions? We first find that parents' descriptions are more accurately comprehended across the board $b=`r acc.lmer.speaker$estimate`, z = `r acc.lmer.speaker$statistic`, p `r papaja::printp(acc.lmer.speaker$p.value)`$. This is in line with our predictions, suggesting that parents in Experiment 1 provided more informative descriptions of the tangrams than did children. Additionally, we find that older children (and parents of older children) provided more accurately comprehended descriptions than younger children, $b=`r acc.lmer.age$estimate`, z= `r acc.lmer.age$statistic`, p `r papaja::printp(acc.lmer.age$p.value)`$ (Figure \ref{fig:e2_result}).
Concerning our second hypothesis, however, we found no significant effect of experiment phase, $b=`r acc.lmer.occ$estimate`, z= `r acc.lmer.occ$statistic`, p= `r acc.lmer.occ$p.value`$. In other words, final-round descriptions of tangrams do not appear to contain meaningfully less information for guessing the target.

## Appendix D: Additional details of Experiment 3 procedure

On the first trial, they saw a picture of a red apple. On the next trial, they saw a pear with a blue border around it and the same apple and were asked to describe the object in the blue box. Then, the experimenter indicated that they would close their eyes on the next trial so that they wouldn't see what children saw. On this trial, children saw a white mug with a blue border around it and a white plate. While the experimenter's eyes were closed, the child was encouraged to describe the object in the blue box so that the experimenter could identify it. Once children provided a description, the blue border disappeared, and the experimenter opened their eyes. The experimenter then identified the object based on children's descriptions, and revealed the blue box again to verify whether they selected the correct target. 

The same procedure was repeated for three more trials with the following image pairs: a red purple ball and a plant; a white rose and a red rose; a round wooden table and a rectangular wooden table. The latter two trials contained object pairs where both objects shared a basic level category label (i.e., "flower" and "table"). These two trials served to subtly indicate to children that referential ambiguity is possible. If children did not uniquely identify the target (e.g. just saying "flower"), the experimenter would indicate that the child's expression was ambiguous, and the experimenter would not select the correct target. While these practice trials provided feedback about ambiguity to the children, the experimenter did not suggest alternate descriptions or examples of unambiguous expressions. Participants then proceeded to the main portion of the experiment, where no further feedback was provided.

At the end of the experiment, children also participated in an additional task designed to measure individual differences understanding ambiguity in *comprehension* [@markman1977realizing; @beal1990development], as failures to judge the informativity of others' expressions may be implicated in failures to produce appropriately informative utterances of one's own in the close condition (e.g. saying "bear" when both the target and distractor are bears).
In this condition, children were told that they would hear a label previously produced by another child, and that they should indicate whether this label adequately identified the target object.
Three of the trials were far trials in which an unambiguously incorrect label was provided to the child (e.g. "table" to distinguish between a pug and a rabbit), three of the trials were close trials in which an unambiguously correct label was provided (e.g. "polar bear" to distinguish between a polar bear and a grizzly bear), and three were close trials in which an ambiguous label was provided (e.g. "dog" to distinguish between a husky and a dalmatian).
Children responded verbally ("yes" it is adequate or "no" it is not) and an experimenter selected the corresponding button on the screen.

## Appendix E: Adult response times reflect familiarity and context in Experiment 3

```{r appendix-rts, out.height = "450px", fig.align = "center", set.cap.width=T, fig.cap = "\\label{fig:rt_appendix} Response times for different conditions in Experiment 3."}
d.prod.rt <- read_csv(
    here("data/experiment3/production_data_lemmatized_cleaned.csv"),
    guess_max = 5000,
    show_col_types = FALSE
  ) %>%
  mutate(button_pressed = as.numeric(button_pressed)) %>%
  filter(age_group == 'adult') %>%
  filter(competitor_type %in% c("close", "far")) %>%
  mutate(logged_rt = log(rt))

# RT by target type
d.prod.rt %>%
  group_by(age_group, target_type, competitor_type, id) %>%
  summarise(logged_rt = mean(logged_rt)) %>%
  ggplot(aes(y = logged_rt, x = competitor_type, color = target_type, fill = target_type)) +
    geom_boxplot(alpha = .4, outlier.shape = NA, width =0.5) +
    geom_jitter(alpha = .2, position = position_jitterdodge(jitter.width = .1, dodge.width = .5)) +
    labs(x = "", y = '(log) response time', fill = 'target', color = 'target') +
    theme(legend.position = "right", aspect.ratio = 2)

# utterance length by target type
# d.prod.rt %>%
#   group_by(age_group, target_type, competitor_type, id) %>%
#   summarise(logged_length = mean(log(utt_length))) %>%
#   ggplot(aes(y = logged_length, x = competitor_type, color = target_type, fill = target_type)) +
#     geom_boxplot(alpha = .4, outlier.shape = NA, width =0.5) +
#     geom_jitter(alpha = .2, position = position_jitterdodge(jitter.width = .1, dodge.width = .5)) +
#     labs(x = "", y = '(log) utterance length', fill = 'target', color = 'target') +
#     theme(legend.position = "right", aspect.ratio = 2)
```

```{r}
# model of logged RTs
rt_model <- d.prod.rt %>%
  lmer(logged_rt ~ competitor_type * target_type + log(utt_length) + (1 + competitor_type * target_type + log(utt_length) |id) + (1 + competitor_type + log(utt_length) |target), 
       data = .) %>%
  tidy() %>%
  filter(effect == "fixed")
```

A further window into referring expression generation is provided by the response time data collected in Experiment 3. 
Response times were recorded between the onset of the trial and the point at which participants finished typing their responses, so longer response times may reflect greater effort in generating a description, all else equal.
We unfortunately do not have accurate measurements of verbal responses for children (an experimenter typed in their responses after some variable delay.)
However, we may nonetheless gain some insight from comparing adults' response times across conditions. 
First, we hypothesized that response times in the "close" contexts would be longer on average than the "far" context, as the closer distractor may rule out more accessible labels and require more effortful search for a referring expression that uniquely identifies the referent. 
Second, we hypothesized that response times for "novel" tangram targets would be longer than "familiar" targets, as the distribution of potential labels is less concentrated on a single, accessible name. 

We tested these hypotheses with a mixed-effects model predicting (logged) response time as a function of context (close vs. far) and familiarity (novel vs. familiar), controlling for utterance length (logged number of characters).
We included the full random effect structure for each participant, as well as intercepts and effect of context for each target:

```
logged_rt ~ competitor_type * target_type + utt_length + 
            (1 + competitor_type * target_type + utt_length | pid) + 
            (1 + competitor_type + utt_length | target)
```

First, we observed a large effect of utterance length, $b=`r (rt_model %>% filter(term == 'utt_length'))$estimate`, t = `r (rt_model %>% filter(term == 'utt_length'))$statistic`, p < 0.001$, which is unsurprising as longer descriptions generally take longer to type. 
After controlling for utterance length, we found that adults' response times were relatively longer when describing tangram images than familiar images  $b=`r (rt_model %>% filter(term == 'target_typetangram'))$estimate`, t = `r (rt_model %>% filter(term == 'target_typetangram'))$statistic`, p < 0.001$. 
We also found that adults' response times were longer for close trials than far trials, $b=`r (rt_model %>% filter(term == 'competitor_typefar'))$estimate`, t = `r (rt_model %>% filter(term == 'competitor_typefar'))$statistic`, p = 0.003$, contrary to our hypothesis. 
We also found evidence for a weak interaction, $b=`r (rt_model %>% filter(term == 'competitor_typefar:target_typetangram'))$estimate`, t = `r (rt_model %>% filter(term == 'competitor_typefar:target_typetangram'))$statistic`, p = 0.05$; see Figure \ref{fig:rt_appendix}.

## Appendix F: Children's understanding of referential ambiguity predicts production in Experiment 3

We found that children are generally less sensitive to referential context than adults, but it is not clear what contributes to these differences.
Given that children are more likely to produce the same label across contexts even for familiar objects, it is unlikely that vocabulary knowledge accounts for most of the difference between children and adults. 
One factor that may influence children's performance is the recognition of referential ambiguity. 
That is, children who understand that ambiguous referring expressions are not sufficiently informative for a partner should show more context sensitivity in our production task.
To assess that children understand the goal of the task, and to aid in our interpretation of any potentially ambiguous responses that children give in earlier trials, we included a manipulation check condition for children. 
We first report children's responses to all three check trial types. 
Then, we turn to analyze how responses to ambiguous check trials (e.g., "dog" to distinguish between a husky and a dalmatian) predicts children's context sensitivity on the production task.

```{r check-trials}

check_trial_data <- d.prod.clean.manual %>%
  filter(competitor_type == "check")

ground_truth_responses <- check_trial_data %>%
  distinct(utterance) %>%
  mutate(unambiguous = utterance %in% c("polar bear", "red flower", "m&ms"),
         wrong = utterance %in% c("cup", "table", "bear"),
         ambiguous = utterance %in% c("dog", "bird", "shirt"))

joined_check_trial_data <- check_trial_data %>%
  left_join(ground_truth_responses, by = "utterance") %>%
  mutate(correct = (unambiguous & button_pressed == 0) | 
           (!unambiguous & button_pressed == 1))
  
subj_check_trial_data <- joined_check_trial_data %>%  
  group_by(age, id) %>%
  summarise(correct = mean(correct))

type_check_trial_data <- joined_check_trial_data %>%
  mutate(check_type = case_when(
    unambiguous ~ "unambiguous",
    wrong ~ "wrong",
    T ~ "ambiguous")) %>%
  group_by(check_type, age, id) %>%
  summarise(correct = mean(correct))

age_model <- type_check_trial_data %>%
  lmer(correct ~ age*check_type + (1|id), data = .) %>%
  tidy() %>%
  filter(effect == "fixed")

check_means <- type_check_trial_data %>%
  ungroup() %>%
  group_by(check_type) %>%
  tidyboot_mean(correct)
  
```


```{r eval = FALSE}
# check trial descriptive plot

ggplot(type_check_trial_data, aes(x = age, y = correct, color = check_type)) +
  facet_wrap(~ check_type) +
  geom_hline(aes(yintercept = .5), linetype = "dashed") +
  geom_smooth(method = 'lm', formula = y ~ poly(x, 2), se = F) +
  geom_jitter(width = 0.05, height = 0.05)

type_check_trial_data %>%
  group_by(age, check_type) %>%
  tidyboot_mean(correct, nboot = 100) %>%
  ggplot(aes(x = age, y = empirical_stat, color = check_type)) +
    facet_wrap(~ check_type) +
    geom_hline(aes(yintercept = .5), linetype = "dashed") +
    geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0) +
    #geom_bin_2d(binwidth = c(1, 0.25))
    geom_smooth(method = 'lm', formula = y ~ poly(x, 2), se = F) +
    geom_point(aes(size = n))

```

```{r plot-check-data, eval = FALSE}
ggplot(subj_check_trial_data, aes(x = age, y = correct)) + 
  geom_jitter() + 
  geom_hline(aes(yintercept = .5), linetype = "dashed")

subj_check_trial_data %>%
  ungroup() %>%
  tidyboot_mean(correct)
```

For all check trials, children were asked to respond yes or no as to whether a provided label uniquely identifies one picture out of two. 
If children are sensitive to informativity of referential expressions, they should respond yes to close trials with *unambiguous* and correct labels (e.g., "red flower" which distinguishes a rose from a lily), no to far trials where the provided labels were unambiguous and *incorrect* (e.g., "table" which fails to distinguish between a pug and a rabbit), and also no to close trials with *ambiguous* expressions (e.g., "dog", which fails to distinguish between a husky and a dalmatian).
First, we found an overall effect of age, where children's accuracy on the check trials increased in older cohorts, $b= `r age_model%>%filter(term == "age")%>%pull(estimate)`$, $t(`r age_model%>%filter(term == "age")%>%pull(df)`) = `r age_model%>%filter(term == "age")%>%pull(statistic)`$, $p `r age_model%>%filter(term == "age")%>%pull(p.value)%>%papaja::printp()`$. 
Second, we found that children typically responded as expected to the unambiguous trials. 
That is, they typically responded no to the incorrect trial (`r check_means%>%filter(check_type == "wrong")%>% pull(mean) * 100`\% correct), and yes to the unambiguous trial (`r check_means%>%filter(check_type == "unambiguous")%>%pull(mean) * 100`\% correct). 
Ambiguous trials were more challenging. 
Across all ages, children made more errors on ambiguous trials (`r check_means%>%filter(check_type == "ambiguous")%>%pull(mean) * 100`\% correct) relative to incorrect trials, $b= `r age_model%>%filter(term == "check_typewrong")%>%pull(estimate)`$, $t(`r age_model%>%filter(term == "check_typewrong")%>%pull(df)`) = `r age_model%>%filter(term == "check_typewrong")%>%pull(statistic)`$, $p `r papaja::printp(age_model%>%filter(term == "check_typewrong")%>%pull(p.value), add_equals = TRUE)`$) and unambiguous trials, $b= `r age_model%>%filter(term == "check_typeunambiguous")%>%pull(estimate)`$, $t(`r age_model%>%filter(term == "check_typeunambiguous")%>%pull(df)`) = `r age_model%>%filter(term == "check_typeunambiguous")%>%pull(statistic)`$, $p `r papaja::printp(age_model%>%filter(term == "check_typeunambiguous")%>%pull(p.value), add_equals = TRUE)`$.
These findings suggest that children, regardless of age, understood that that goal of the task was to describe a target picture (and not, for instance, to simply say anything). 

```{r}
kid_data <- indiv.measures %>%
  filter(age_group=="kid") 

#predicting context sensitivity by overall manipulation check performance
kid_model_data <- kid_data %>%
  group_by(id, target_type) %>%
  tidyboot_mean(close_far.distance) %>%
  left_join(subj_check_trial_data, by = "id")

kid_model <- kid_model_data %>%
  lm(empirical_stat ~ target_type*correct, data = .) %>%
  tidy() 

#only ambiguous manipulation check trials

ambiguous_check_data <- type_check_trial_data %>%
  filter(check_type == "ambiguous")

kid_ambiguous_model_data <- kid_data %>%
  group_by(id, target_type) %>%
  tidyboot_mean(close_far.distance) %>%
  left_join(ambiguous_check_data, by = "id")

kid_ambiguous_model_data$target_type <- relevel(factor(kid_ambiguous_model_data$target_type), ref = "tangram")

kid_ambiguous_model <- kid_ambiguous_model_data %>%
  lmer(empirical_stat ~ target_type*correct + 
         (1|id) + (1|age), data = .) %>%
  tidy() %>%
  filter(effect == "fixed")

kid_age_model <- kid_ambiguous_model_data %>%
  lmer(empirical_stat ~ age*target_type + (1|id), data = .) %>%
  tidy() %>%
  filter(effect == "fixed")

#predicting context sensitivity by age

kid_age_data <- kid_data %>%
  left_join(subj_check_trial_data, by = "id") %>%
  group_by(age, target_type) %>%
  tidyboot_mean(close_far.distance)

kid_age_model <- kid_age_data %>%
  lm(empirical_stat ~ age*target_type, data = .) %>%
  tidy()

```

```{r eval= FALSE}
#unused plots predicting context sensitivity

#all check trials
ggplot(kid_model_data, aes(x = correct, y = empirical_stat)) +
         geom_jitter() +
         geom_smooth(method = "lm") +
         facet_wrap(~target_type)

#age
ggplot(kid_age_data, aes(x = age, y = empirical_stat)) +
  geom_jitter() +
  geom_smooth(method = "lm") +
  facet_wrap(~target_type)

```

```{r e3-check, fig.pos = "t", fig.align = "center", fig.width = 10, fig.cap = "\\label{fig:e3_check} Children's performance on ambiguous manipulation check trials predicted their context sensitivity (measured by exact matches in descriptions between close and far contexts) for familiar objects, but not for tangrams. Note that there were only three ambiguous manipulation check trials, thus only four possible accuracy rates"}

ggplot(kid_ambiguous_model_data, aes(x = correct, y = empirical_stat)) +
         geom_point(color = CHILDREN) +
         geom_smooth(method = "lm", color = CHILDREN) +
         labs(x = "accuracy on ambiguous trials", y = "context sensitivity") +
         facet_wrap(~target_type) +
     theme(aspect.ratio = 1, text = element_text(size = 16))

```

To assess whether recognition of referential ambiguity correlated with performance on the production task, we focused specifically on children's performance on the ambiguous check trials. On these trials, children were asked whether a given description was sufficient for distinguishing a target from its distractor. 
We predicted that children who could recognize ambiguity on these trials would also be more likely to produce informative descriptions.
We fit a mixed-effects model predicting children's context sensitivity, as measured by 'exact match' overlap, from their performance on the ambiguous trials and target type (familiar vs. tangram), with random effects of participant and age. We found a significant interaction between accuracy on the ambiguous trials and target type, such that children who were more accurate on the ambiguous check trials were more likely to modulate their descriptions based on context for familiar items, $b = `r kid_ambiguous_model%>%filter(term == "target_typefamiliar:correct")%>%pull(estimate)`,~t(`r kid_ambiguous_model%>%filter(term == "target_typefamiliar:correct")%>%pull(df)`) = `r kid_ambiguous_model%>%filter(term == "target_typefamiliar:correct")%>%pull(statistic)`, p `r kid_ambiguous_model%>%filter(term == "target_typefamiliar:correct")%>%pull(p.value) %>% papaja::printp(add_equals = TRUE)`$. 
In other words, children who were more sensitive to referential ambiguity were less likely to produce the same descriptions for familiar items across close and far contexts (Figure \ref{fig:e3_check}). 


```{r appendix-Levensthein, out.height = "450px", fig.align = "center", set.cap.width=T, fig.cap = "\\label{fig:Levensthein_appendix} Measuring context overlap using continuous Levensthein distance (rather than exact match probability)."}
contextsensitivity.distance <- indiv.measures %>%
  group_by(age_group, target_type) %>%
  tidyboot_mean(close_far.distance, na.rm = T)

contextsensitivity.distance %>%
  ggplot(aes(x = age_group, y = empirical_stat, fill = target_type)) +
    geom_bar(stat = 'identity', position = dodge) +
    geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0, position = dodge) +
    labs(title = 'Levensthein distance between conditions', 
         y = 'Levenshtein distance between close and far conditions', x = '') +
    theme(aspect.ratio = 1, legend.position = "right")
```

```{r appendix-full-comprehension-model}
bind_rows(tidy_turk_data, tidy_kid_data)  %>%
  filter(measure == "correct") %>%
  mutate(age = age - 6, occurrence = occurrence - 1.5) %>%
  glmer(as.logical(value) ~ comprehender_group + age + person + occurrence + (1 + comprehender_group + person | gameid),
       data = .,
       family = binomial,
       contrasts = list(comprehender_group = contr.sum(2), person = contr.sum(2)),
       control = glmerControl(optimizer = 'bobyqa')) %>%
  tidy() %>%
  filter(effect == 'fixed') %>%
  select(-effect, -group) %>%
  kable(
    format = "latex",
    booktabs = TRUE,
    caption = "\\label{tab:comprehension} Output of full comprehension model: \\texttt{accuracy $\\sim$ comprehender\\_group + age + person + occurrence + (1 + comprehender\\_group + person | gameid)}"
  )
```

```{r appendix-full-comprehension-model2, warning = FALSE, message = FALSE}
repeated_subset <- bind_rows(tidy_turk_data, tidy_kid_data)  %>%
    filter(measure == "correct") %>%
    group_by(comprehender_group, audioid) %>%
    summarize(n = n()) %>% group_by(audioid) %>% summarize(nn = n()) %>% filter(nn > 1) %>% pull(audioid)

output <- capture.output(brms_out <- bind_rows(tidy_turk_data, tidy_kid_data)  %>%
  filter(measure == "correct") %>%
  mutate(age = age - 6, occurrence = occurrence - 1.5) %>%
  filter(audioid %in% repeated_subset) %>%
  brms::brm(value ~ comprehender_group + (1 + comprehender_group | audioid),
       data = .,
       family = 'bernoulli'))

brms_out %>%
  tidy() %>%
  filter(effect == 'fixed') %>%
  select(-effect, -group, -component) %>%
  kable(
    format = "latex",
    booktabs = TRUE,
    caption = "\\label{tab:comprehension2} Output of Bayesian model with stimulus-level random effects: \\texttt{accuracy $\\sim$ comprehender\\_group + (1 + comprehender\\_group | audioid)}"
  )
```
